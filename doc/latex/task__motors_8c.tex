\hypertarget{task__motors_8c}{\section{task\-\_\-motors.\-c File Reference}
\label{task__motors_8c}\index{task\-\_\-motors.\-c@{task\-\_\-motors.\-c}}
}


This file contains functions for motor drivers, encoders, and the motor tasks.  


{\ttfamily \#include $<$avr/io.\-h$>$}\\*
{\ttfamily \#include \char`\"{}Free\-R\-T\-O\-S.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}task.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}queue.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}croutine.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}semphr.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}uart.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}pid.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}shares.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}task\-\_\-motors.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}math.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}task\-\_\-master.\-h\char`\"{}}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{task__motors_8c_af02e2149caeb6116f256783348031c86}{encoders\-\_\-init} (void)
\begin{DoxyCompactList}\small\item\em This function initializes both motor encoders. \end{DoxyCompactList}\item 
void \hyperlink{task__motors_8c_abad32bfc46c9f31ba81955775611bd21}{motors\-\_\-init} (void)
\begin{DoxyCompactList}\small\item\em This function initializes both motors. \end{DoxyCompactList}\item 
void \hyperlink{task__motors_8c_a4a3771bfff5cda74266bca25133d5da2}{motor1\-\_\-power} (int16\-\_\-t power)
\begin{DoxyCompactList}\small\item\em This function sets the power level for motor 1. \end{DoxyCompactList}\item 
void \hyperlink{task__motors_8c_a4f737ef3a26d7c4f12bb85c764c01873}{motor2\-\_\-power} (int16\-\_\-t power)
\begin{DoxyCompactList}\small\item\em This function sets the power level for motor 2. \end{DoxyCompactList}\item 
void \hyperlink{task__motors_8c_a4ec60e37ee03593e7370bfbf5e223588}{task\-\_\-motor1} (void $\ast$pv\-Parameters)
\begin{DoxyCompactList}\small\item\em This is the task function for motor 1. \end{DoxyCompactList}\item 
void \hyperlink{task__motors_8c_a27f6dd12d5a0dabaf8c6f050c05077cf}{task\-\_\-motor2} (void $\ast$pv\-Parameters)
\begin{DoxyCompactList}\small\item\em This is the task function for motor 2. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hypertarget{task__motors_8c_a20fe1ce9b7dca58347cb93a0c8dd7038}{volatile uint8\-\_\-t {\bfseries int\-\_\-occurred}}\label{task__motors_8c_a20fe1ce9b7dca58347cb93a0c8dd7038}

\item 
\hypertarget{task__motors_8c_adad6e7df88cfe127024bad0b9e569e78}{int16\-\_\-t {\bfseries motor1\-\_\-power\-\_\-\-S\-H\-A\-R\-E\-D}}\label{task__motors_8c_adad6e7df88cfe127024bad0b9e569e78}

\item 
\hypertarget{task__motors_8c_a743406399a2a85e5bb57c2b144c16e58}{int16\-\_\-t {\bfseries motor2\-\_\-power\-\_\-\-S\-H\-A\-R\-E\-D}}\label{task__motors_8c_a743406399a2a85e5bb57c2b144c16e58}

\item 
\hypertarget{task__motors_8c_aa4290c48912e5cf0b57c5822ab76ac5d}{volatile int16\-\_\-t {\bfseries position\-\_\-\-M2\-\_\-\-S\-H\-A\-R\-E\-D}}\label{task__motors_8c_aa4290c48912e5cf0b57c5822ab76ac5d}

\item 
\hypertarget{task__motors_8c_a86d2e07f5c8d7cae698a8be41279ce24}{volatile int16\-\_\-t {\bfseries position\-\_\-\-M1\-\_\-\-S\-H\-A\-R\-E\-D}}\label{task__motors_8c_a86d2e07f5c8d7cae698a8be41279ce24}

\item 
\hypertarget{task__motors_8c_abcb4d7d0f967a27cc5fa61737789d8ba}{volatile uint16\-\_\-t {\bfseries error\-\_\-\-M1\-\_\-\-S\-H\-A\-R\-E\-D}}\label{task__motors_8c_abcb4d7d0f967a27cc5fa61737789d8ba}

\item 
\hypertarget{task__motors_8c_ad296bcf975af3d49c903400eb336a89b}{volatile uint16\-\_\-t {\bfseries error\-\_\-\-M2\-\_\-\-S\-H\-A\-R\-E\-D}}\label{task__motors_8c_ad296bcf975af3d49c903400eb336a89b}

\item 
\hypertarget{task__motors_8c_ab196a3c67f6496cf92ebe86594b9cfdf}{int16\-\_\-t {\bfseries position\-\_\-cmd\-\_\-\-M1\-\_\-\-S\-H\-A\-R\-E\-D}}\label{task__motors_8c_ab196a3c67f6496cf92ebe86594b9cfdf}

\item 
\hypertarget{task__motors_8c_a58b3d7c33ee40d0448f9cb86fc7d1efb}{int16\-\_\-t {\bfseries position\-\_\-cmd\-\_\-\-M2\-\_\-\-S\-H\-A\-R\-E\-D}}\label{task__motors_8c_a58b3d7c33ee40d0448f9cb86fc7d1efb}

\item 
\hypertarget{task__motors_8c_a13e25999a58778ef007e2d4457d471c3}{int16\-\_\-t {\bfseries position\-\_\-targ\-\_\-init\-\_\-\-S\-H\-A\-R\-E\-D}}\label{task__motors_8c_a13e25999a58778ef007e2d4457d471c3}

\end{DoxyCompactItemize}


\subsection{Detailed Description}
This file contains functions for motor drivers, encoders, and the motor tasks. Revisions\-: \begin{DoxyItemize}
\item 11-\/27-\/2014 J\-F, M\-L, J\-R created original file\end{DoxyItemize}
License\-: This file is copyright 2012 by J\-F, M\-L, J\-R and released under the Lesser G\-N\-U Public License, version 2. It intended for educational use only, but its use is not limited thereto. 

Definition in file \hyperlink{task__motors_8c_source}{task\-\_\-motors.\-c}.



\subsection{Function Documentation}
\hypertarget{task__motors_8c_af02e2149caeb6116f256783348031c86}{\index{task\-\_\-motors.\-c@{task\-\_\-motors.\-c}!encoders\-\_\-init@{encoders\-\_\-init}}
\index{encoders\-\_\-init@{encoders\-\_\-init}!task_motors.c@{task\-\_\-motors.\-c}}
\subsubsection[{encoders\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}void encoders\-\_\-init (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{task__motors_8c_af02e2149caeb6116f256783348031c86}


This function initializes both motor encoders. 

This function initializes all of the required pins, variables, and interrupts necessary to use the quadrature encoders. 

Definition at line 60 of file task\-\_\-motors.\-c.



Referenced by main().

\hypertarget{task__motors_8c_a4a3771bfff5cda74266bca25133d5da2}{\index{task\-\_\-motors.\-c@{task\-\_\-motors.\-c}!motor1\-\_\-power@{motor1\-\_\-power}}
\index{motor1\-\_\-power@{motor1\-\_\-power}!task_motors.c@{task\-\_\-motors.\-c}}
\subsubsection[{motor1\-\_\-power}]{\setlength{\rightskip}{0pt plus 5cm}void motor1\-\_\-power (
\begin{DoxyParamCaption}
\item[{int16\-\_\-t}]{power}
\end{DoxyParamCaption}
)}}\label{task__motors_8c_a4a3771bfff5cda74266bca25133d5da2}


This function sets the power level for motor 1. 

This function converts a signed integer into a pwm signal and direction command for the vnh5019 motor driver chips. 
\begin{DoxyParams}{Parameters}
{\em power} & The signed 16-\/bit integer corresponding to the magnitude and direction of power applied to the motors. \\
\hline
\end{DoxyParams}


Definition at line 127 of file task\-\_\-motors.\-c.



Referenced by task\-\_\-motor1().

\hypertarget{task__motors_8c_a4f737ef3a26d7c4f12bb85c764c01873}{\index{task\-\_\-motors.\-c@{task\-\_\-motors.\-c}!motor2\-\_\-power@{motor2\-\_\-power}}
\index{motor2\-\_\-power@{motor2\-\_\-power}!task_motors.c@{task\-\_\-motors.\-c}}
\subsubsection[{motor2\-\_\-power}]{\setlength{\rightskip}{0pt plus 5cm}void motor2\-\_\-power (
\begin{DoxyParamCaption}
\item[{int16\-\_\-t}]{power}
\end{DoxyParamCaption}
)}}\label{task__motors_8c_a4f737ef3a26d7c4f12bb85c764c01873}


This function sets the power level for motor 2. 

This function converts a signed integer into a pwm signal and direction command for the vnh5019 motor driver chips. 
\begin{DoxyParams}{Parameters}
{\em power} & The signed 16-\/bit integer corresponding to the magnitude and direction of power applied to the motors. \\
\hline
\end{DoxyParams}


Definition at line 161 of file task\-\_\-motors.\-c.



Referenced by task\-\_\-motor2().

\hypertarget{task__motors_8c_abad32bfc46c9f31ba81955775611bd21}{\index{task\-\_\-motors.\-c@{task\-\_\-motors.\-c}!motors\-\_\-init@{motors\-\_\-init}}
\index{motors\-\_\-init@{motors\-\_\-init}!task_motors.c@{task\-\_\-motors.\-c}}
\subsubsection[{motors\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}void motors\-\_\-init (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{task__motors_8c_abad32bfc46c9f31ba81955775611bd21}


This function initializes both motors. 

This function initializes all required pins and variables for the motors, and also initializes timer 1 to generate an output pwm signal for both motor controllers. 

Definition at line 86 of file task\-\_\-motors.\-c.



Referenced by task\-\_\-motor1(), and task\-\_\-motor2().

\hypertarget{task__motors_8c_a4ec60e37ee03593e7370bfbf5e223588}{\index{task\-\_\-motors.\-c@{task\-\_\-motors.\-c}!task\-\_\-motor1@{task\-\_\-motor1}}
\index{task\-\_\-motor1@{task\-\_\-motor1}!task_motors.c@{task\-\_\-motors.\-c}}
\subsubsection[{task\-\_\-motor1}]{\setlength{\rightskip}{0pt plus 5cm}void task\-\_\-motor1 (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{pv\-Parameters}
\end{DoxyParamCaption}
)}}\label{task__motors_8c_a4ec60e37ee03593e7370bfbf5e223588}


This is the task function for motor 1. 

This function decides, based on the system state, which control signal gets to set the power level of motor 1. System state is decided/updated in task\-\_\-master. 

Definition at line 193 of file task\-\_\-motors.\-c.



References motor1\-\_\-power(), and motors\-\_\-init().



Referenced by main().

\hypertarget{task__motors_8c_a27f6dd12d5a0dabaf8c6f050c05077cf}{\index{task\-\_\-motors.\-c@{task\-\_\-motors.\-c}!task\-\_\-motor2@{task\-\_\-motor2}}
\index{task\-\_\-motor2@{task\-\_\-motor2}!task_motors.c@{task\-\_\-motors.\-c}}
\subsubsection[{task\-\_\-motor2}]{\setlength{\rightskip}{0pt plus 5cm}void task\-\_\-motor2 (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{pv\-Parameters}
\end{DoxyParamCaption}
)}}\label{task__motors_8c_a27f6dd12d5a0dabaf8c6f050c05077cf}


This is the task function for motor 2. 

This function decides, based on the system state, which control signal gets to set the power level of motor 2. System state is decided in task\-\_\-master. 

Definition at line 269 of file task\-\_\-motors.\-c.



References motor2\-\_\-power(), and motors\-\_\-init().



Referenced by main().

